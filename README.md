# 项目书：递归折叠式对话树（Hyperlinked Recursive Chat）

## 一、项目背景

随着大型语言模型（LLM）在教育、科研和知识管理中的应用日益广泛，传统的线性对话模式存在以下问题：

1. **信息过载**：一次性回答可能包含大量专业术语或复杂概念，用户难以完全消化。  
2. **上下文混乱**：用户在追问不同子话题时，线性对话无法隔离不同分支的上下文。  
3. **可读性差**：复杂的追问会使对话历史冗长，不利于浏览和复用。

因此，需要一种 **折叠式递归对话树** 的交互模式，使用户能够按需展开、追问，并保持上下文隔离。

---

## 二、项目目标

1. **树形结构对话**  
   - 用户可以对回答的任意部分进行追问，生成子节点对话。  
   - 对话节点可折叠/展开，形成一颗递归树。  

2. **上下文继承与隔离**  
   - 子节点继承父节点上下文。  
   - 不继承平行分支（兄弟节点）信息，避免信息污染。  

3. **可视化与交互体验**  
   - 对话树可直观展示，支持点击展开/折叠。  
   - 支持选中术语或句子生成子对话（类似超链接的交互）。

---

## 三、实现方案

### 3.1 架构设计

- **前端**：  
  - 使用 React/Vue 等现代前端框架  
  - 支持递归组件渲染折叠/展开节点  
  - 支持选中节点或文本生成子节点对话  

- **后端 / LLM 调用**：  
  - 管理对话树结构（JSON 或数据库）  
  - 每次生成回答时仅传递父节点上下文  
  - 可选摘要父节点信息以优化 token 使用  

- **数据结构示例（JSON）**：
```json
{
  "id": "root",
  "text": "根节点对话",
  "children": [
    {
      "id": "A",
      "text": "子节点 A",
      "children": [
        {
          "id": "C",
          "text": "子节点 C"
        }
      ]
    },
    {
      "id": "B",
      "text": "子节点 B",
      "children": [
        {
          "id": "D",
          "text": "子节点 D"
        }
      ]
    }
  ]
}
````

### 3.2 上下文管理策略

* 每个节点保存沿父链的历史文本。
* 子节点生成回答时只传入相关父链文本。
* 平行兄弟节点的对话不传入，保证上下文隔离。

### 3.3 技术难点

1. **上下文长度限制**

   * GPT / Claude 的 token 窗口有限，需要做摘要或压缩。

2. **递归树渲染与 UX**

   * 避免层级过深导致用户迷路
   * 折叠/展开的交互设计

3. **分支记忆隔离**

   * 保证子节点追问仅依赖父节点上下文，不泄露平行分支信息

---

## 四、预期效果

1. **用户体验提升**

   * 用户可以按需展开复杂概念，减少信息过载
   * 追问不同子话题时上下文清晰，不混乱

2. **知识管理便利**

   * 对话树可以保存、复用、分享
   * 可作为教育或科研的互动式知识库

3. **商业与研究价值**

   * 适合教育 AI、科研助手、企业内部知识管理
   * 提供差异化的交互体验

---

## 五、扩展与未来方向

1. **多媒体融合**：在节点中支持图片、图表、代码块等扩展内容
2. **跨会话记忆**：允许用户选择性保存某些节点到长期知识库
3. **协作与分享**：多用户可在同一对话树上协作追问

---

## 六、结论

通过递归折叠式对话树，用户可以更自然地与 LLM 交互，实现按需深入、上下文隔离、信息可视化的对话体验。这种模式兼具教育、科研和知识管理价值，具有显著前景。
